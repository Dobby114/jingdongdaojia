"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[523],{7086:function(t,n,a){a.d(n,{r:function(){return s}});var c=a(2262),e=a(3907);const s=()=>{const t=(0,e.oR)(),n=(n,a,c,e)=>{t.commit("changeCount",{shopId:n,productId:a,productInfo:c,num:e})},{cartList:a}=(0,c.BK)(t.state);return{cartList:a,changeCount:n}}},4325:function(t,n,a){a.d(n,{Z:function(){return m}});var c=a(6252),e=a(3577);const s={class:"shop"},o={class:"container"},l=["src"],i={class:"title"},r={class:"tag"},u={class:"highlight"};function d(t,n,a,d,h,_){const p=(0,c.up)("router-link");return(0,c.wg)(),(0,c.iD)("li",s,[(0,c.Wm)(p,{to:`/shop/${a.item.name?a.item.name:a.item._id}`},{default:(0,c.w5)((()=>[(0,c._)("div",o,[(0,c._)("img",{src:a.item.imgUrl,alt:""},null,8,l)]),(0,c._)("div",{class:(0,e.C_)({shop__info:!0,"shop__info--border":!a.hiddeBorder})},[(0,c._)("h4",i,(0,e.zw)(a.item.name?a.item.name:a.item._id),1),(0,c._)("div",r,[(0,c._)("span",null,"月售:"+(0,e.zw)(a.item.sales),1),(0,c._)("span",null,"起送:"+(0,e.zw)(a.item.expressLimit),1),(0,c._)("span",null,"基础运费:"+(0,e.zw)(a.item.expressPrice),1),((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(a.item.tag,((t,n)=>((0,c.wg)(),(0,c.iD)("span",{key:n},(0,e.zw)(t),1)))),128))]),(0,c._)("div",u,(0,e.zw)(a.item.slogan),1)],2)])),_:1},8,["to"])])}var h={name:"ShopInfo",props:["item","hiddeBorder"]},_=a(3744);const p=(0,_.Z)(h,[["render",d],["__scopeId","data-v-7d836894"]]);var m=p},2186:function(t,n,a){a.d(n,{Z:function(){return h},S:function(){return i}});var c=a(6252),e=a(3577);const s={class:"toast"};function o(t,n,a,o,l,i){return(0,c.wg)(),(0,c.iD)("div",s,(0,e.zw)(a.toastMessa),1)}var l=a(2262);const i=()=>{const t=(0,l.qj)({show:!1,toastMessa:""}),n=n=>{t.show=!0,t.toastMessa=n,setTimeout((()=>{t.show=!1,t.toastMessa=""}),2e3)},{show:a,toastMessa:c}=(0,l.BK)(t);return{show:a,toastMessa:c,showToast:n}};var r={name:"Toast",props:["toastMessa"]},u=a(3744);const d=(0,u.Z)(r,[["render",o],["__scopeId","data-v-6d51e152"]]);var h=d},5492:function(t,n,a){a.r(n),a.d(n,{default:function(){return F}});var c=a(6252),e=a(9963);const s=t=>((0,c.dD)("data-v-0206c4dd"),t=t(),(0,c.Cn)(),t),o={class:"wrapper"},l={class:"top"},i=s((()=>(0,c._)("div",{class:"search"},[(0,c._)("a",{href:"#",class:"iconfont search__icon"},""),(0,c._)("input",{type:"text",placeholder:"请输入商品名称搜索"})],-1)));function r(t,n,a,s,r,u){const d=(0,c.up)("router-link"),h=(0,c.up)("ShopInfo"),_=(0,c.up)("Content"),p=(0,c.up)("ShopCart");return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",null,[(0,c._)("div",o,[(0,c._)("div",l,[(0,c.Wm)(d,{to:"../",class:"back iconfont"},{default:(0,c.w5)((()=>[(0,c.Uk)("")])),_:1}),i]),(0,c.wy)((0,c.Wm)(h,{item:s.item,hiddeBorder:!0},null,8,["item"]),[[e.F8,s.item.imgUrl]]),(0,c.Wm)(_)])]),(0,c.Wm)(p)],64)}var u=a(2262),d=a(4325),h=a(3577);const _={class:"content"},p={class:"content__nav"},m=["onClick"],C={class:"content__goods"},w=["src"],g={class:"info"},v={class:"price"},k={class:"price__now"},f={class:"price__origin"},b={class:"number"},S=["onClick"],I=["onClick"];function y(t,n,a,e,s,o){return(0,c.wg)(),(0,c.iD)("div",_,[(0,c._)("div",p,[(0,c._)("ul",null,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(e.categotyInfo,(t=>((0,c.wg)(),(0,c.iD)("li",{key:t.name,onClick:()=>{e.handleCategotyClick(t.tab)},class:(0,h.C_)({"content__nav--active":t.tab===e.curTab})},(0,h.zw)(t.name),11,m)))),128))])]),(0,c._)("div",C,[(0,c._)("ul",null,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(e.content,(t=>((0,c.wg)(),(0,c.iD)("li",{key:t._id},[(0,c._)("img",{src:t.imgUrl,alt:""},null,8,w),(0,c._)("div",g,[(0,c._)("h3",null,(0,h.zw)(t.name),1),(0,c._)("p",null,"月售"+(0,h.zw)(t.sales)+"件",1),(0,c._)("div",v,[(0,c._)("div",k,(0,h.zw)(t.price),1),(0,c._)("div",f,(0,h.zw)(t.oldPrice),1)])]),(0,c._)("div",b,[(0,c._)("span",{class:"number__minus",onClick:()=>{e.changeCount(e.shopId,t._id,t,-1)}},"-",8,S),(0,c.Uk)((0,h.zw)(e.cartList?.[e.shopId]?.[t._id]?.count||0)+" ",1),(0,c._)("span",{class:"number__add",onClick:()=>{e.changeCount(e.shopId,t._id,t,1)}},"+",8,I)])])))),128))])])])}var z=a(4471),L=a(2201),M=a(7086);const D=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],T=()=>{const t=(0,u.iH)(D[0].tab),n=n=>{t.value=n};return{curTab:t,handleCategotyClick:n}},H=(t,n)=>{const a=(0,u.qj)({content:[]}),e=async()=>{const c=await(0,z.t5)(`/api/shop/${n}/products`,{tab:t.value});0===c?.errno&&c?.data&&(a.content=c.data)};(0,c.m0)((()=>{e()}));const{content:s}=(0,u.BK)(a),{cartList:o,changeCount:l}=(0,M.r)();return{cartList:o,changeCount:l,content:s}};var Z={name:"Content",setup(){const t=(0,L.yj)(),n=t.params.id,{curTab:a,handleCategotyClick:c}=T(),{content:e,cartList:s,changeCount:o}=H(a,n);return{shopId:n,categotyInfo:D,content:e,handleCategotyClick:c,curTab:a,cartList:s,changeCount:o}}},A=a(3744);const P=(0,A.Z)(Z,[["render",y],["__scopeId","data-v-d57d11a4"]]);var j=P,U=a(5984);const K=()=>{const t=(0,L.yj)(),n=(0,u.qj)({item:{}}),a=async()=>{const a=await(0,z.t5)(`/api/shop/${t.params.id}`);0===a?.errno&&a?.data&&(n.item=a.data)},{item:c}=(0,u.BK)(n);return a(),{item:c}};var B={name:"Shop",components:{ShopInfo:d.Z,Content:j,ShopCart:U.Z},setup(){const{item:t}=K();return{item:t}}};const q=(0,A.Z)(B,[["render",r],["__scopeId","data-v-0206c4dd"]]);var F=q},5984:function(t,n,a){a.d(n,{Z:function(){return K},F:function(){return Z}});var c=a(6252),e=a(3577),s=a(9963);const o=t=>((0,c.dD)("data-v-36cdfab3"),t=t(),(0,c.Cn)(),t),l={key:1,class:"product"},i={class:"product__state"},r={class:"product__state__selectall"},u=["innerHTML"],d=["innerHTML","onClick"],h=["src"],_={class:"info"},p={class:"price"},m={class:"price__now"},C={class:"price__origin"},w={class:"number"},g=["onClick"],v=["onClick"],k={class:"bottom"},f=o((()=>(0,c._)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",alt:""},null,-1))),b={class:"tag"},S={class:"bottom__allprice"},I={class:"price"};function y(t,n,a,o,y,z){const L=(0,c.up)("Toast");return(0,c.wg)(),(0,c.iD)(c.HY,null,[o.showCartList&&o.calculate.totalNum>0?((0,c.wg)(),(0,c.iD)("div",{key:0,class:"mask",onClick:n[0]||(n[0]=(...t)=>o.handleShowCartlist&&o.handleShowCartlist(...t))})):(0,c.kq)("",!0),o.showCartList&&o.calculate.totalNum>0?((0,c.wg)(),(0,c.iD)("div",l,[(0,c._)("div",i,[(0,c._)("div",r,[(0,c._)("span",{class:"icon iconfont",innerHTML:o.calculate.allSelectd?"":"",onClick:n[1]||(n[1]=()=>{o.changeSelectAllState(o.shopId)})},null,8,u),(0,c.Uk)(" 全选 ")]),(0,c._)("div",{class:"product__state__cleanall",onClick:n[2]||(n[2]=()=>{o.clearAll(o.shopId)})}," 清空购物车 ")]),(0,c._)("ul",null,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(o.product,(t=>(0,c.wy)(((0,c.wg)(),(0,c.iD)("li",{key:t._id},[(0,c._)("div",{class:"iconfont check",innerHTML:t.check?"":"",onClick:()=>o.changeProductCheck(o.shopId,t._id)},null,8,d),(0,c._)("img",{src:t.imgUrl,alt:""},null,8,h),(0,c._)("div",_,[(0,c._)("h3",null,(0,e.zw)(t.name),1),(0,c._)("div",p,[(0,c._)("div",m,(0,e.zw)(t.price),1),(0,c._)("div",C,(0,e.zw)(t.oldPrice),1)])]),(0,c._)("div",w,[(0,c._)("span",{class:"number__minus",onClick:()=>{o.changeCount(o.shopId,t._id,t,-1)}},"-",8,g),(0,c.Uk)((0,e.zw)(t.count||0)+" ",1),(0,c._)("span",{class:"number__add",onClick:()=>{o.changeCount(o.shopId,t._id,t,1)}},"+",8,v)])])),[[s.F8,t.count>0]]))),128))])])):(0,c.kq)("",!0),(0,c._)("div",k,[(0,c._)("div",{class:"bottom__basket",onClick:n[3]||(n[3]=(...t)=>o.handleShowCartlist&&o.handleShowCartlist(...t))},[f,(0,c._)("div",b,(0,e.zw)(o.calculate.totalNum),1)]),(0,c._)("div",S,[(0,c.Uk)(" 总计："),(0,c._)("span",I,"¥"+(0,e.zw)(o.calculate.totalPrice),1)]),(0,c._)("div",{class:"bottom__check",onClick:n[4]||(n[4]=(...t)=>o.checkClick&&o.checkClick(...t))},"去结算")]),o.show?((0,c.wg)(),(0,c.j4)(L,{key:2,toastMessa:o.toastMessa},null,8,["toastMessa"])):(0,c.kq)("",!0)],64)}a(7658);var z=a(2262),L=a(2201),M=a(3907),D=a(7086),T=a(2186);const H=(t,n)=>{const a=(0,L.tv)(),{show:c,toastMessa:e,showToast:s}=(0,T.S)(),o=()=>{"{}"===JSON.stringify(t.value)?s("请至少添加一种添加商品!"):a.push({path:`/orderConfirmation/${n}`})};return{checkClick:o,show:c,toastMessa:e}},Z=(t,n)=>{const a=(0,M.oR)(),e=a.state.cartList,s=(0,c.Fl)((()=>{const a=e[t];let c=0,s=0,o=!0;if(a)for(const t in a){const n=a[t];c+=n.count,n.check&&(s+=n.count*n.price),n.check||(o=!1)}return c<=0&&(n.value=!1),s=s.toFixed(2),{totalNum:c,totalPrice:s,allSelectd:o}})),o=(0,c.Fl)((()=>{const n=e[t]||{};return n})),{changeCount:l}=(0,D.r)(),i=(t,n)=>{a.commit("changeProductCheck",{shopId:t,productId:n})},r=t=>{a.commit("changeSelectAllState",{shopId:t})},u=t=>{a.commit("clearAll",{shopId:t})};return{calculate:s,product:o,changeCount:l,changeProductCheck:i,changeSelectAllState:r,clearAll:u}},A=()=>{const t=(0,z.iH)(!1),n=()=>{t.value=!t.value};return{showCartList:t,handleShowCartlist:n}};var P={name:"ShopCart",components:{Toast:T.Z},setup(){const t=(0,L.yj)(),n=t.params.id,{showCartList:a,handleShowCartlist:c}=A(),{calculate:e,product:s,changeCount:o,changeProductCheck:l,changeSelectAllState:i,clearAll:r}=Z(n,a),{checkClick:u,show:d,toastMessa:h}=H(s,n);return{calculate:e,product:s,shopId:n,showCartList:a,changeCount:o,changeProductCheck:l,changeSelectAllState:i,clearAll:r,handleShowCartlist:c,checkClick:u,show:d,toastMessa:h}}},j=a(3744);const U=(0,j.Z)(P,[["render",y],["__scopeId","data-v-36cdfab3"]]);var K=U}}]);
//# sourceMappingURL=shop.f3542ecd.js.map